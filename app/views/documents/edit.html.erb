<% content_for :header_title, "Documents" %>
<% content_for :header_javascript do %>
  <%= javascript_include_tag "https://js.shubox.io/v1/#{Rails.application.secrets.shubox_js_id}.js", defer: true %>
<% end %>

<div class="form-card" id="document-drop">
  <header class="form-card__header">
    <div class="step-section-header">
      <div class="step-section-header__subhead">
        Submit Documents
      </div>
    </div>
  </header>
  <div class="form-card__content">
    <p>
      If you can, we suggest submitting documents like a copy of your ID, proof
      of income, or proof of residency. You can also do this later if now is
      not a good time.
    </p>
    <p>
      Clicking the "Upload documents button" below, or dragging and dropping
      photos or documents onto this area of the page, will upload them.
    </p>
    <p>
      Clicking "Continue" will attach these documents to your application.
    </p>

    <%= form_for @step,
      as: :step,
      builder: MbFormBuilder,
      url: current_path,
      method: :put,
      html: { data: { 'documents-form' => 'true' } } do |f| %>

      <div class="form-card__documents" id="form-card__documents">
        <%= render partial: 'document',
          collection: current_snap_application.documents,
          as: :url %>

        <script id="form-card__documents__handlebars_template" type="text/x-handlebars-template">
          <%= render "document", url: nil %>
        </script>
      </div>

      <div class="form-card__documents__ctas">
        <button type="button" class="button button--next button--cta button--full-width" id="click-to-upload">
          <i class="icon-file_upload"></i>
          Upload documents
        </button>

        <%= link_to next_path, class: "button" do %>
          I'll do this later
        <% end %>
      </div>

      <%= render 'shared/next_step', disabled: true %>
    <% end %>
  </div>
</div>

<% unless Rails.env.test? -%>
  <script>
    window.onload = function() { uploadSetup("<%= j render "uploading" %>") }
  </script>
<% end -%>
